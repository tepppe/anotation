<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="description" content="jp270405060706001224041382139satxeasyhs7">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
</head>
<title>video</title>
<body>
  <div id="kaishi">
    <table>
      <tr>
        <th>氏名：</th><td><input id="name" type="text"></td>
      </tr>
    </table>
    <div class="btn btn-primary" type="button" onClick="log_in()">名前記入完了</div>
  </div>
<div id="bigbig">
  <input id="file1" type="file" onChange="uploadFile1()">
  <div class="big">
    <div class="row">
      <div class="col-7">
        <div class="index1">
          <span id="a"></span>
        </div>
        <div class="index2">
          <span id="b"></span>
        </div>
      </div>
      <div class="col-5">
        <div class="row">
          <div class="col-2">
            <table>
              <tr><td>現在（秒）<br>：<span id="position">0</span></td></tr>
              <tr><td>全体（秒）<br>：<span id="length"></span></td></tr>
              <tr><td>再生速度  <br>：<span id="speed">1.0</span></td></tr>
              <tr><td>音量     <br>：<span id="volume">1.0</span></td></tr>
              <tr><td><span id="message"></span></td></tr>
            </table>
          </div>
          <div class="col-10">
            <div class="index3">
              <table class="table">
                <tr>
                  <td><div id="p1" class="btn btn-primary" type="button" onClick="playVideo()">再生</div></td>
                  <td><div id="p2" class="btn btn-primary" type="button" onClick="pauseVideo()">一時停止</div></td>
                </tr>
                <tr>
                  <td><div id="p3" class="btn btn-primary" type="button" onClick="seekDown()">1秒前</div></td>
                  <td><div id="p4" class="btn btn-primary" type="button" onClick="seekUp()">1秒後</div></td>
                  <td><div id="p10" class="btn btn-primary" type="button" onClick="seekDown01()">0.1秒前</div></td>
                  <td><div id="p11" class="btn btn-primary" type="button" onClick="seekUp01()">0.1秒後</div></td>
                </tr>
                <tr>
                  <td><div id="p5" class="btn btn-primary" type="button" onClick="fast()">-0.1倍</div></td>
                  <td><div id="p6" class="btn btn-primary" type="button" onClick="slow()">+0.1倍</div></td>
                  <td><div id="p7" class="btn btn-primary" type="button" onClick="setSpeed(1)">元の速度</div></td>
                </tr>
                <tr>
                  <td><div id="p8" class="btn btn-primary" type="button" onClick="seekToTop()">先頭へ</div></td>
                  <td><div id="p9" class="btn btn-primary" type="button" onClick="seekToLast()">最後へ</div></td>
                  
                </tr>
              </table>
            </div>
          </div>
        </div>
        <br>
        <div class="index6">
          <div id="finish"></div>
          <div id="kekka">
            <table>
              <tr>
                <th>タグ名：</th><td><select id="tag">
                  <option value=1>足首</option>
                  <option value=2>膝</option>
                  <option value=3>足首の角度</option>
                  <option value=4>腰の位置</option>
                  <option value=5>手</option>
                  <option value=6>顔</option>
                  <option value=7>腰の捻り</option>
                  <option value=8>足の付け根</option>
                  <option value=9>手の角度</option>
                </select>
                </td>
              </tr>
              <tr>
                <th>コメント：</th><td><input id="comment" type="text"></td>
              </tr>
              <tr>
                <th>何秒から何秒か：</th><td><input id="second1" type="text" size="3">秒〜<input id="second2" type="text" size="3">秒</td>
              </tr>
              <tr>
                <th>円の大きさ：</th><td><select id="select">
                  <option value=100>大</option>
                  <option value=50>中</option>
                  <option value=10>小</option>
                </select></td>
              </tr>
            </table>
            <div id="kokonibtn"></div><div id="kokonibtn2"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="index5">
      <div id="anobefore">
        <table id="table2">
          <tbody id="body">
          <tr>
              <th class="fixed01">　　　　　　</th><td class="fixed02"><div id="time">0</div></td>
          </tr>
          <tr>
              <th class="fixed02">足首</th><td><div id="h1"></div></td>
          </tr>
          <tr>
              <th class="fixed02">膝</th><td><div id="h2"></div></td>
          </tr>
          <tr>
              <th class="fixed02">足首の角度</th><td><div id="h3"></div></td>
          </tr>
          <tr>
              <th class="fixed02">腰の位置</th><td><div id="h4"></div></td>
          </tr>
          <tr>
              <th class="fixed02">手</th><td><div id="h5"></div></td>
          </tr>
          <tr>
              <th class="fixed02">顔</th><td><div id="h6"></div></td>
          </tr>
          <tr>
              <th class="fixed02">腰の捻り</th><td><div id="h7"></div></td>
          </tr>
          <tr>
              <th class="fixed02">足の付け根</th><td><div id="h8"></div></td>
          </tr>
          <tr>
              <th class="fixed02">手の角度</th><td><div id="h9"></div></td>
          </tr>
          </tbody>
        </table>
      </div>
      <div id="anoafter">
        <table id="table3">
          <tbody id="body1">
          <tr>
              <th class="fixed01">　　　　　　</th><td class="fixed02"><div id="time">0</div></td>
          </tr>
          <tr>
              <th class="fixed02">足首</th><td><div id="i1"></div></td>
          </tr>
          <tr>
              <th class="fixed02">足首</th><td><div id="j1"></div></td>
          </tr>
          <tr>
              <th class="fixed02">膝</th><td><div id="i2"></div></td>
          </tr>
          <tr>
              <th class="fixed02">膝</th><td><div id="j2"></div></td>
          </tr>
          <tr>
              <th class="fixed02">足首の角度</th><td><div id="i3"></div></td>
          </tr>
          <tr>
              <th class="fixed02">足首の角度</th><td><div id="j3"></div></td>
          </tr>
          <tr>
              <th class="fixed02">腰の位置</th><td><div id="i4"></div></td>
          </tr>
          <tr>
              <th class="fixed02">腰の位置</th><td><div id="j4"></div></td>
          </tr>
          <tr>
              <th class="fixed02">手</th><td><div id="i5"></div></td>
          </tr>
          <tr>
              <th class="fixed02">手</th><td><div id="j5"></div></td>
          </tr>
          <tr>
              <th class="fixed02">顔</th><td><div id="i6"></div></td>
          </tr>
          <tr>
              <th class="fixed02">顔</th><td><div id="j6"></div></td>
          </tr>
          <tr>
              <th class="fixed02">腰の捻り</th><td><div id="i7"></div></td>
          </tr>
          <tr>
              <th class="fixed02">腰の捻り</th><td><div id="j7"></div></td>
          </tr>
          <tr>
              <th class="fixed02">足の付け根</th><td><div id="i8"></div></td>
          </tr>
          <tr>
              <th class="fixed02">足の付け根</th><td><div id="j8"></div></td>
          </tr>
          <tr>
              <th class="fixed02">手の角度</th><td><div id="i9"></div></td>
          </tr>
          <tr>
              <th class="fixed02">手の角度</th><td><div id="j9"></div></td>
          </tr>
          </tbody>
        </table>
      </div> 
    </div>
  </div> 
</div>
</body>
<script src="jquery-1.12.4.min.js"></script>
<script type="text/javascript">
var docchi;
var canvas;
var ctx;
var i1;
var i2;
var i3;
var i4;
//＊この上２ついらない方がいいかも
const tagsu=10;
const byousu=10;
var kosuu;
var greens;
var hozon = 0;
var login = 0;
var login_name=[];
var login_name_1=[]
var hozonbox_name=[];
var hozonbox_tag=[];
var hozonbox_comment=[];
var hozonbox_second1=[];
var hozonbox_second2=[];
var hozonbox_select=[];
var hozonbox_x=[];
var hozonbox_y=[];
var hozonbox_name_1=[];
var hozonbox_tag_1=[];
var hozonbox_comment_1=[];
var hozonbox_second1_1=[];
var hozonbox_second2_1=[];
var hozonbox_select_1=[];
var hozonbox_x_1=[];
var hozonbox_y_1=[];
var selected_tag=[];
var selected_comment=[];
var selected_second1=[];
var selected_second2=[];
var selected_select=[];
var selected_x=[];
var selected_y=[];
document.getElementById("anoafter").style.display ="none";
document.getElementById("bigbig").style.display ="none";
var v;
function init_video(){
  v = document.getElementById("video");
  v.controls=false;
  v.onloadeddata = function()
  {
    document.getElementById("length").innerHTML = Math.floor(v.duration*byousu)/byousu;
    blackboard(Number(v.duration*byousu));
    console.log(Number(v.duration));
    suuji(Number(v.duration));
    document.getElementById("body").style.overflow='auto';
    document.getElementById("body1").style.overflow='auto';
    var botan=document.getElementById("kokonibtn");
    botan.innerHTML='<input type="button" onClick="rightbox('+v.duration+')" value="記入完了"><input type="button" onClick="anofinish()" value="アノテーション終了">';

  }
  
  
  v.addEventListener("timeupdate", function(){
    document.getElementById("position").innerHTML = Math.floor(v.currentTime*byousu)/byousu;
    document.getElementById("speed").innerHTML = v.playbackRate.toFixed(1);
    setInterval(function(){
      //この下はタグの数の１０
      for(var i=1; i<tagsu;i++){
      kara(i,Math.floor(v.currentTime*byousu));
      }
    },10); 
  }, false);

  v.addEventListener("ended", function(){
    document.getElementById("message").innerHTML = "finished";
  }, false);

  v.addEventListener("pause", function(){
    document.getElementById("message").innerHTML = "paused";
  },false);
}

function playVideo() {
    document.getElementById("message").innerHTML = "playing..";
    v.play();
}

function pauseVideo() {
    v.pause();
}

function seekUp() {
    var seeku=Math.floor(v.currentTime*byousu);
    v.currentTime += 1;
    //この下の１０はタグの数
    for(i=1;i<tagsu;i++){
      if(seeku%byousu==0){
        document.getElementById(i+"xx"+(seeku)).style.color="blue";
        document.getElementById(i+"x"+(seeku)).style.color="blue";
        document.getElementById(i+"xxx"+(seeku)).style.color="blue";
      }else{
        document.getElementById(i+"xx"+(seeku)).style.color="white";
        document.getElementById(i+"x"+(seeku)).style.color="white";
        document.getElementById(i+"xxx"+(seeku)).style.color="white";
      } 
      //ここからできてない
      for(var jj=0;jj<hozon;jj++){
        if(Number(hozonbox_second1[jj])*byousu<=(seeku)&&(seeku)<=Number(hozonbox_second2[jj])*byousu){
          if(i==hozonbox_tag[jj]){
            if(login_name[login-1] == hozonbox_name[jj]){
              document.getElementById(i+"xx"+(seeku)).style.color="red";
            }             
          }
        }
      }
      if(greens==1){
        for(var jj=0;jj<kosuu;jj++){
          if(Number(selected_second1[jj])*byousu<=seeku&&seeku<=Number(selected_second2[jj])*byousu){
            if(i==selected_tag[jj]){
              document.getElementById(i+"xxx"+seeku).style.color="green";
            }
          }
        }
        for(var jj=0;jj<hozon;jj++){
          if(Number(hozonbox_second1[jj])*byousu<=seeku&&seeku<=Number(hozonbox_second2[jj])*byousu){
            if(i==hozonbox_tag[jj]){
              if(login_name[login-1] == hozonbox_name[jj]){
                document.getElementById(i+"x"+seeku).style.color="red";
              } 
            }
          }
        }
      }
    }
}

function seekUp01() {
    v.currentTime += 0.1;
}

function seekDown() {
    var seekd=Math.floor(v.currentTime*byousu);
    v.currentTime -= 1;
    //この下の１０はタグの数
    for(i=1;i<tagsu;i++){
      if(seekd%byousu==0){
        document.getElementById(i+"xx"+(seekd)).style.color="blue";
        document.getElementById(i+"x"+(seekd)).style.color="blue";
        document.getElementById(i+"xxx"+(seekd)).style.color="blue";
      }else{
        document.getElementById(i+"xx"+(seekd)).style.color="white";
        document.getElementById(i+"x"+(seekd)).style.color="white";
        document.getElementById(i+"xxx"+(seekd)).style.color="white";
      } 
      //ここからできてない
      for(var jj=0;jj<hozon;jj++){
        if(Number(hozonbox_second1[jj])*byousu<=(seekd)&&(seekd)<=Number(hozonbox_second2[jj])*byousu){
          if(i==hozonbox_tag[jj]){
            if(login_name[login-1] == hozonbox_name[jj]){
              document.getElementById(i+"xx"+(seekd)).style.color="red";
            }
          }
        }
      }
      if(greens==1){
        for(var jj=0;jj<kosuu;jj++){
          if(Number(selected_second1[jj])*byousu<=seekd&&seekd<=Number(selected_second2[jj])*byousu){
            if(i==selected_tag[jj]){
              document.getElementById(i+"xxx"+seekd).style.color="green";
            }
          }
        }
        for(var jj=0;jj<hozon;jj++){
          if(Number(hozonbox_second1[jj])*byousu<=seekd&&seekd<=Number(hozonbox_second2[jj])*byousu){
            if(i==hozonbox_tag[jj]){
              if(login_name[login-1] == hozonbox_name[jj]){
                document.getElementById(i+"x"+seekd).style.color="red";
              } 
            }
          }
        }
      }
    }
}

function seekDown01() {
    var seekd01=Math.floor(v.currentTime*byousu);
    v.currentTime -= 0.1;
    //この下の１０はタグの数
    for(i=1;i<tagsu;i++){
      if(seekd01%byousu==0){
        document.getElementById(i+"xx"+(seekd01)).style.color="blue";
        document.getElementById(i+"x"+(seekd01)).style.color="blue";
        document.getElementById(i+"xxx"+(seekd01)).style.color="blue";
      }else{
        document.getElementById(i+"xx"+(seekd01)).style.color="white";
        document.getElementById(i+"x"+(seekd01)).style.color="white";
        document.getElementById(i+"xxx"+(seekd01)).style.color="white";
      } 
      //ここからできてない
      for(var jj=0;jj<hozon;jj++){
        if(Number(hozonbox_second1[jj])*byousu<=(seekd01)&&(seekd01)<=Number(hozonbox_second2[jj])*byousu){
          if(i==hozonbox_tag[jj]){
            if(login_name[login-1] == hozonbox_name[jj]){
              document.getElementById(i+"xx"+(seekd01)).style.color="red";
            }
          }
        }
      }
      if(greens==1){
        for(var jj=0;jj<kosuu;jj++){
          if(Number(selected_second1[jj])*byousu<=seekd01&&seekd01<=Number(selected_second2[jj])*byousu){
            if(i==selected_tag[jj]){
              document.getElementById(i+"xxx"+seekd01).style.color="green";
            }
          }
        }
        for(var jj=0;jj<hozon;jj++){
          if(Number(hozonbox_second1[jj])*byousu<=seekd01&&seekd01<=Number(hozonbox_second2[jj])*byousu){
            if(i==hozonbox_tag[jj]){
              if(login_name[login-1] == hozonbox_name[jj]){
                document.getElementById(i+"x"+seekd01).style.color="red";
              } 
            }
          }
        }
      }
    }
}

function seekToTop(){
    var seektt=Math.floor(v.currentTime*byousu);
    v.currentTime = 0;
    //この下の１０はタグの数
    for(i=1;i<tagsu;i++){
      if(seektt%byousu==0){
        document.getElementById(i+"xx"+(seektt)).style.color="blue";
        document.getElementById(i+"x"+(seektt)).style.color="blue";
        document.getElementById(i+"xxx"+(seektt)).style.color="blue";
      }else{
        document.getElementById(i+"xx"+(seektt)).style.color="white";
        document.getElementById(i+"x"+(seektt)).style.color="white";
        document.getElementById(i+"xxx"+(seektt)).style.color="white";
      } 
      //ここからできてない
      for(var jj=0;jj<hozon;jj++){
        if(Number(hozonbox_second1[jj])*byousu<=(seektt)&&(seektt)<=Number(hozonbox_second2[jj])*byousu){
          if(i==hozonbox_tag[jj]){
            if(login_name[login-1] == hozonbox_name[jj]){
              document.getElementById(i+"xx"+(seektt)).style.color="red";
            } 
            
          }
        }
      }
      if(greens==1){
        for(var jj=0;jj<kosuu;jj++){
          if(Number(selected_second1[jj])*byousu<=seektt&&seektt<=Number(selected_second2[jj])*byousu){
            if(i==selected_tag[jj]){
              document.getElementById(i+"xxx"+seektt).style.color="green";
            }
          }
        }
        for(var jj=0;jj<hozon;jj++){
          if(Number(hozonbox_second1[jj])*byousu<=seektt&&seektt<=Number(hozonbox_second2[jj])*byousu){
            if(i==hozonbox_tag[jj]){
              if(login_name[login-1] == hozonbox_name[jj]){
                document.getElementById(i+"x"+seektt).style.color="red";
              } 
            }
          }
        }
      }
    }
}

function seekToLast(){
    var seektl=Math.floor(v.currentTime*byousu);
    v.currentTime = v.duration;
    //この下の１０はタグの数
    for(i=1;i<tagsu;i++){
      if(seektl%byousu==0){
        document.getElementById(i+"xx"+(seektl)).style.color="blue";
        document.getElementById(i+"x"+(seektl)).style.color="blue";
        document.getElementById(i+"xxx"+(seektl)).style.color="blue";
      }else{
        document.getElementById(i+"xx"+(seektl)).style.color="white";
        document.getElementById(i+"x"+(seektl)).style.color="white";
        document.getElementById(i+"xxx"+(seektl)).style.color="white";
      } 
      //ここからできてない
      for(var jj=0;jj<hozon;jj++){
        if(Number(hozonbox_second1[jj])*byousu<=(seektl)&&(seektl)<=Number(hozonbox_second2[jj])*byousu){
          if(i==hozonbox_tag[jj]){
            if(login_name[login-1] == hozonbox_name[jj]){
              document.getElementById(i+"xx"+(seektl)).style.color="red";
            }       
          }
        }
      }
      if(greens==1){
        for(var jj=0;jj<kosuu;jj++){
          if(Number(selected_second1[jj])*byousu<=seektl&&seektl<=Number(selected_second2[jj])*byousu){
            if(i==selected_tag[jj]){
              document.getElementById(i+"xxx"+seektl).style.color="green";
            }
          }
        }
        for(var jj=0;jj<hozon;jj++){
          if(Number(hozonbox_second1[jj])*byousu<=seektl&&seektl<=Number(hozonbox_second2[jj])*byousu){
            if(i==hozonbox_tag[jj]){
              if(login_name[login-1] == hozonbox_name[jj]){
                document.getElementById(i+"x"+seektl).style.color="red";
              } 
            }
          }
        }      
      }
    }
}

function slow() {
    v.playbackRate += 0.1;
}

function setSpeed( speed ) {
    if ( speed < 0.1 ){
        speed = 0.1;
    }
    v.playbackRate = speed;
}

function fast() {
    if ( v.playbackRate > 0.1){
        v.playbackRate -= 0.1;
    }
}

init_video();
function down(id){
  var elm = document.getElementById(id);
  elm.style.backgroundColor="#000";
  elm.style.color="#FFF";
}

function up(id){
  var elm = document.getElementById(id);
  elm.style.backgroundColor="#FFF";
  elm.style.color="#000";
}

function kara(a,b){
  document.getElementById(a+"xx"+b).style.color="black";
  document.getElementById(a+"x"+b).style.color="black";
  document.getElementById(a+"xxx"+b).style.color="black";
  if(b>0){
    if(b%byousu==1){
      document.getElementById(a+"xx"+(b-1)).style.color="blue";
      document.getElementById(a+"x"+(b-1)).style.color="blue";
      document.getElementById(a+"xxx"+(b-1)).style.color="blue";
    }else{
      document.getElementById(a+"xx"+(b-1)).style.color="white";
      document.getElementById(a+"x"+(b-1)).style.color="white";
      document.getElementById(a+"xxx"+(b-1)).style.color="white";
    } 
    //この１０は１秒ごとに入れてる。■の数が１秒で５個にするなら割る数は５になる
    for(var jj=0;jj<hozon;jj++){
      if(Number(hozonbox_second1[jj])*byousu<=(b-1)&&(b-1)<=Number(hozonbox_second2[jj])*byousu){
        if(a==hozonbox_tag[jj]){
          if(login_name[login-1] == hozonbox_name[jj]){
            document.getElementById(a+"xx"+(b-1)).style.color="red";
            document.getElementById(a+"x"+(b-1)).style.color="red";
          } 
        }
      }
    }
    //できたかも
    if(greens==1){
      for(var jj=0;jj<kosuu;jj++){
        if(Number(selected_second1[jj])*byousu<=(b-1)&&(b-1)<=Number(selected_second2[jj])*byousu){
          if(a==selected_tag[jj]){
            document.getElementById(a+"xxx"+(b-1)).style.color="green";
          }
        }
      }
    }
  }
}

function kakikomi(a){

  var x=10000;
  var y=10000;
  var douga = document.getElementById("video");
  var elm = document.getElementById("b");
  console.log(douga.videoWidth);
  elm.innerHTML='<canvas id="myCanvas" height=480px width='+douga.videoWidth*480/douga.videoHeight+'px></canvas>';
  init_video();
  $(function(){
    canvas = $("#myCanvas")[0];
    ctx = canvas.getContext('2d');
    $("#myCanvas").click( drawAnyLine );
  });
  function drawAnyLine(e){
    var bounding = e.target.getBoundingClientRect() ;
    x = Math.floor(e.clientX - bounding.left);
    y = Math.floor(e.clientY - bounding.top);
    ctx.lineWidth = 1;
    ctx.strokeStyle = "#ff00ff";
    ctx.beginPath();
    ctx.arc( x, y, a, 0, Math.PI*2, false );
    ctx.stroke();  
    var kakikomiowari2 = document.getElementById("kokonibtn2");
    kakikomiowari2.innerHTML='<input type="button" onClick="clean('+douga.videoWidth*480/douga.videoHeight+')" value="書き直す"><input type="button" onClick="shuryou('+douga.videoWidth*480/douga.videoHeight+','+x+','+y+')" value="書き込み終了">';
  }
  console.log("=============")
  console.log(x); 
  console.log(y); 
  console.log("=============")
  var kakikomiowari = document.getElementById("kokonibtn2");
  kakikomiowari.innerHTML='<input type="button" onClick="clean('+douga.videoWidth*480/douga.videoHeight+')" value="書き直す"><input type="button" onClick="shuryou('+douga.videoWidth*480/douga.videoHeight+','+x+','+y+')" value="書き込み終了">';
}

function kakikomidake(a,b,c){
  var douga2 = document.getElementById("video");
  var elm = document.getElementById("b");
  console.log(douga2.videoWidth);
  elm.innerHTML='<canvas id="myCanvas" height=480px width='+douga2.videoWidth*480/douga2.videoHeight+'px></canvas>';
  init_video();
  $(function(){
    canvas = $("#myCanvas")[0];
    ctx = canvas.getContext('2d');
    ctx.lineWidth = 1;
    ctx.strokeStyle = "green";
    ctx.beginPath();
    ctx.arc( a, b, c, 0, Math.PI*2, false );
    ctx.stroke(); 
  });
}

function kakikomidake2(a,b,c){
  var douga3 = document.getElementById("video");
  var elm = document.getElementById("b");
  console.log(douga3.videoWidth);
  elm.innerHTML='<canvas id="myCanvas" height=480px width='+douga3.videoWidth*480/douga3.videoHeight+'px></canvas>';
  init_video();
  $(function(){
    canvas = $("#myCanvas")[0];
    ctx = canvas.getContext('2d');
    ctx.lineWidth = 1;
    ctx.strokeStyle = "red";
    ctx.beginPath();
    ctx.arc( a, b, c, 0, Math.PI*2, false );
    ctx.stroke(); 
  });
}

function clean(a){
  ctx.clearRect( 0, 0, a, 480 );
}

function shuryou(a,b,c){
  ctx.clearRect( 0, 0, a, 480 );
  var shuuryou=document.getElementById("kokonibtn2");
  var shuuryou2=document.getElementById("b");
  shuuryou.innerHTML="";
  shuuryou2.innerHTML="";
  FileSave(b,c);
}

function anofinish(){
  document.getElementById("anobefore").style.display ="none";
  document.getElementById("anoafter").style.display ="block";
  for( var i = 1; i < tagsu; i ++ ){
    for(var j = 0; j < Number(v.duration*byousu);j++){
      for(var ii = 0;ii<hozon;ii++){
        if(hozonbox_name[ii]==login_name[login-1]){
          if(i==hozonbox_tag[ii]){
            if(Number(hozonbox_second1[ii])*byousu<=j&&j<=Number(hozonbox_second2[ii])*byousu){
              chalk3(i,j,hozonbox_second1[ii]);
            }
          }
        }
      }
    }
  }
  var elmshuryo=document.getElementById("finish");
  elmshuryo.innerHTML="<select id='kojinmei'></select><input type='button' onClick='hozonshare()' value='選択完了'><input id='kirikaeru' type='button' onClick='kirikae()' value='切り替え'><br/><div id='hyoji' style='color:green'></div><div id='hyoji2'style='color:red'></div>";
  var f = Number(v.duration*byousu);
  for(var i = 1; i < tagsu; i++){
    for(var j = 0; j < f; j++){
      chalkoriginal(i,j);
    }
  }
  anoshare();
  document.getElementById("kekka").style.display ="none";
}

function anoshare(){
  var kojinnmei=document.getElementById("kojinmei");
  for(var i=0;i<login;i++){
    var option1=document.createElement("option");
    option1.value=i;
    option1.textContent=login_name[i];
    kojinnmei.appendChild(option1);
  }
}

//csvにするならhozonshare()は変える必要あり
function hozonshare(){
  //csvにするなら下２行変える必要あり
  var selectshare = document.getElementById("kojinmei").value;
  var selectedname = login_name[selectshare];
  kosuu=0;
  for(var i=0;i<hozon;i++){
    if(hozonbox_name[i]==selectedname){
      kosuu+=1;
    }
  }
  for(var i=0;i<kosuu;i++){
    selected_tag[i]=0;
    selected_comment[i]=0;
    selected_second1[i]=0;
    selected_second2[i]=0;
    selected_select[i]=0;
    selected_x[i]=0;
    selected_y[i]=0;
  }
  var kosuu2=0;
  for(var i=0;i<hozon;i++){
    if(hozonbox_name[i]==selectedname){
      selected_tag[kosuu2]=hozonbox_tag[i];
      selected_comment[kosuu2]=hozonbox_comment[i];
      selected_second1[kosuu2]=hozonbox_second1[i];
      selected_second2[kosuu2]=hozonbox_second2[i];
      selected_select[kosuu2]=hozonbox_select[i];
      selected_x[kosuu2]=hozonbox_x[i];
      selected_y[kosuu2]=hozonbox_y[i];
      kosuu2+=1;
    }
  }
  greens=1;
  for(var i=0;i<kosuu2;i++){
    for(var j=Number(selected_second1[i])*byousu;j<=Number(selected_second2[i])*byousu;j++){
      chalk1(selected_tag[i],j,selected_second1[i]);
    }
  }  
}

function FileSave(a,b){
  var elmname = document.getElementById( "name" );
  var elmtag = document.getElementById( "tag" );
  var elmcomment = document.getElementById( "comment" );
  var elmsecond1 = document.getElementById( "second1" );
  var elmsecond2 = document.getElementById( "second2" );
  var elmselect = document.getElementById( "select" );
  var name_2=elmname.value;
  var tag_2 = Number(elmtag.value);
  var comment_2=elmcomment.value;
  var second1_2 = Number(elmsecond1.value);
  var second2_2 = Number(elmsecond2.value);
  var select_2 = Number(elmselect.value);
  console.log(name_2);
  for(var ii=0;ii<hozon+1;ii++){
    hozonbox_name[ii]=0;
    hozonbox_tag[ii]=0;
    hozonbox_comment[ii]=0;
    hozonbox_second1[ii]=0;
    hozonbox_second2[ii]=0;
    hozonbox_select[ii]=0;
    hozonbox_x[ii]=0;
    hozonbox_y[ii]=0;
  }
  if(hozon==0){
    hozonbox_name[0]=name_2;
    hozonbox_tag[0]=tag_2;
    hozonbox_comment[0]=comment_2;
    hozonbox_second1[0]=second1_2;
    hozonbox_second2[0]=second2_2;
    hozonbox_select[0]=select_2;
    hozonbox_x[0]=a;
    hozonbox_y[0]=b;
    hozonbox_name_1[0]=0;
    hozonbox_tag_1[0]=0; 
    hozonbox_comment_1[0]=0;
    hozonbox_second1_1[0]=0;
    hozonbox_second2_1[0]=0;
    hozonbox_select_1[0]=0;
    hozonbox_x_1[0]=0;
    hozonbox_y_1[0]=0;
    hozonbox_name_1[0]=name_2;
    hozonbox_tag_1[0]=tag_2; 
    hozonbox_comment_1[0]=comment_2;
    hozonbox_second1_1[0]=second1_2;
    hozonbox_second2_1[0]=second2_2;
    hozonbox_select_1[0]=select_2;
    hozonbox_x_1[0]=a;
    hozonbox_y_1[0]=b;
    console.log(hozonbox_name[0]);
  }else{
    for(var jj=0;jj<hozon;jj++){
      hozonbox_name[jj]=hozonbox_name_1[jj];
      hozonbox_tag[jj]=hozonbox_tag_1[jj];
      hozonbox_comment[jj]=hozonbox_comment_1[jj];
      hozonbox_second1[jj]=hozonbox_second1_1[jj];
      hozonbox_second2[jj]=hozonbox_second2_1[jj];
      hozonbox_select[jj]=hozonbox_select_1[jj];
      hozonbox_x[jj]=hozonbox_x_1[jj];
      hozonbox_y[jj]=hozonbox_y_1[jj];
    }
    for(var ii=0;ii<hozon+1;ii++){
    hozonbox_name_1[ii]=0;
    hozonbox_tag_1[ii]=0;
    hozonbox_comment_1[ii]=0;
    hozonbox_second1_1[ii]=0;
    hozonbox_second2_1[ii]=0;
    hozonbox_select_1[ii]=0;
    hozonbox_x_1[ii]=0;
    hozonbox_y_1[ii]=0;
    }
    hozonbox_name[hozon]=name_2;
    hozonbox_tag[hozon]=tag_2;
    hozonbox_comment[hozon]=comment_2;
    hozonbox_second1[hozon]=second1_2;
    hozonbox_second2[hozon]=second2_2;
    hozonbox_select[hozon]=select_2;
    hozonbox_x[hozon]=a;
    hozonbox_y[hozon]=b;
    hozonbox_name_1[hozon]=name_2;
    hozonbox_tag_1[hozon]=tag_2; 
    hozonbox_comment_1[hozon]=comment_2;
    hozonbox_second1_1[hozon]=second1_2;
    hozonbox_second2_1[hozon]=second2_2;
    hozonbox_select_1[hozon]=select_2;
    hozonbox_x_1[hozon]=a;
    hozonbox_y_1[hozon]=b;
    for(var jj=0;jj<hozon+1;jj++){
      hozonbox_name_1[jj]=hozonbox_name[jj];
      hozonbox_tag_1[jj]=hozonbox_tag[jj];
      hozonbox_comment_1[jj]=hozonbox_comment[jj];
      hozonbox_second1_1[jj]=hozonbox_second1[jj];
      hozonbox_second2_1[jj]=hozonbox_second2[jj];
      hozonbox_select_1[jj]=hozonbox_select[jj];
      hozonbox_x_1[jj]=hozonbox_x[jj];
      hozonbox_y_1[jj]=hozonbox_y[jj];
    }
  }
  console.log(hozonbox_y_1[0]);
  hozon=hozon+1;
  var hozonowari=document.getElementById("kokonibtn2");//これ怪しい
  hozonowari.innerHTML="";
  //これ以降hozonは＋１の状態なので注意  
}

function aa(a,b){
  if(b="video/mp4"){
    b=".mp4";
  }else if(b="video/webm"){
    b=".webm";
  }else if(b="video/ogv"){
    b=".ogv";
  }else{
    alert("このファイルは開けません");
  }
  var elm = document.getElementById("a");
  elm.innerHTML='<video id="video" height=480px autoplay="autplay" controls="controls"><br/><source src="'+a+'"><br/></video>';
  init_video();
}

function uploadFile1() {
  const file1 = document.getElementById("file1").files[0];
  aa(file1.name,file1.type);
}

function kirikae(){
  if(document.getElementById("hyoji").style.display =="block"){
    docchi=0;
    document.getElementById("hyoji").style.display ="none";
    document.getElementById("hyoji2").style.display ="block";
  }else{
    docchi=1;
    document.getElementById("hyoji").style.display ="block";
    document.getElementById("hyoji2").style.display ="none";
  }
}

//切り替えた時の書き込みがうまく行ってない
function anohyouji(a,b){
  var kirikaeruu=document.getElementById("kirikaeru");
  document.getElementById("hyoji").style.display ="block";
  document.getElementById("hyoji2").style.display ="none";
  var hyoji=document.getElementById("hyoji");
  var hyoji2_1=document.getElementById("hyoji2");
  for(var jj=0;jj<kosuu;jj++){
    if(Number(selected_second1[jj])*byousu<=b&&b<=Number(selected_second2[jj])*byousu){
      if(a==selected_tag[jj]){
        hyoji.innerHTML="タグ名："+selected_tag[jj]+"<br/>コメント："+selected_comment[jj]+"<br/>秒数："+selected_second1[jj]+"秒から"+selected_second2[jj]+"秒";
        kakikomidake(selected_x[jj],selected_y[jj],selected_select[jj]);
        i1=jj;
        kirikaeruu.addEventListener("click",function(){
          if(docchi==1){
            kakikomidake(selected_x[i1],selected_y[i1],selected_select[i1]);
          }
        },false);
      }
    }
  }
  for(var ii=0;ii<hozon;ii++){
    if(hozonbox_name[ii]==login_name[login-1]){
      if(hozonbox_tag[ii]==a){
        if(Number(selected_second1[ii])*byousu<=b&&b<=Number(selected_second2[ii])*byousu){
          hyoji2_1.innerHTML="タグ名："+hozonbox_tag[ii]+"<br/>コメント："+hozonbox_comment[ii]+"<br/>秒数："+hozonbox_second1[ii]+"秒から"+hozonbox_second2[ii]+"秒";
          i2=ii;
          kirikaeruu.addEventListener("click",function(){
            if(docchi==0){
              kakikomidake2(hozonbox_x[i2],hozonbox_y[i2],hozonbox_select[i2]);
            }
          },false); 
        }
      }
    }
  }
}

//切り替えた時の書き込みがうまく行ってない
//kirikaeruu2.addEventListener("click"←これにしたらバグった？
function anohyouji2(a,b){
  docchi=0;
  var kirikaeruu2=document.getElementById("kirikaeru");
  document.getElementById("hyoji").style.display ="none";
  document.getElementById("hyoji2").style.display ="block";
  var hyoji2=document.getElementById("hyoji2");
  var hyoji_1=document.getElementById("hyoji");
  for(var ii=0;ii<hozon;ii++){
    if(hozonbox_name[ii]==login_name[login-1]){
      if(hozonbox_tag[ii]==a){
        if(Number(selected_second1[ii])*byousu<=b&&b<=Number(selected_second2[ii])*byousu){
          hyoji2.innerHTML="タグ名："+hozonbox_tag[ii]+"<br/>コメント："+hozonbox_comment[ii]+"<br/>秒数："+hozonbox_second1[ii]+"秒から"+hozonbox_second2[ii]+"秒";
          kakikomidake2(hozonbox_x[ii],hozonbox_y[ii],hozonbox_select[ii]);
          i3=ii;
          kirikaeruu2.addEventListener("click",function(){
            if(docchi==0){
              kakikomidake2(hozonbox_x[i3],hozonbox_y[i3],hozonbox_select[i3]);
            }
          },false);
        }
      }
    }
  }
  for(var jj=0;jj<kosuu;jj++){
    if(Number(selected_second1[jj])*byousu<=b&&b<=Number(selected_second2[jj])*byousu){
      if(a==selected_tag[jj]){
        hyoji_1.innerHTML="タグ名："+selected_tag[jj]+"<br/>コメント："+selected_comment[jj]+"<br/>秒数："+selected_second1[jj]+"秒から"+selected_second2[jj]+"秒";
        i4=jj;
        kirikaeruu2.addEventListener("click",function(){
          if(docchi==1){
            kakikomidake(selected_x[i4],selected_y[i4],selected_select[i4]);
          }
        },false);
      }
    }
  }
}

function chalk1( i, j ,k ){
  var seco = document.getElementById(i+"xxx"+j);
  seco.style.color="green";
  var saisei = document.getElementById(i+"xxx"+j);
  saisei.addEventListener("click",function(){
    var dd=Math.floor(v.currentTime*byousu);
    v.currentTime=k;
    anohyouji(i,j);
    //この下の１０はタグの数
    for(var s=1;s<tagsu;s++){
      if(dd%byousu==0){
        document.getElementById(s+"xxx"+dd).style.color="blue";
        document.getElementById(s+"x"+dd).style.color="blue";
      }else{
        document.getElementById(s+"xxx"+dd).style.color="white";
        document.getElementById(s+"x"+dd).style.color="white";
      } 
      //この１０は１秒ごとに入れてる。■の数が１秒で５個にするなら割る数は５になる
      for(var jj=0;jj<kosuu;jj++){
        if(Number(selected_second1[jj])*byousu<=dd&&dd<=Number(selected_second2[jj])*byousu){
          if(s==selected_tag[jj]){
            document.getElementById(s+"xxx"+dd).style.color="green";
          }
        }
      }
      for(var jj=0;jj<hozon;jj++){
        if(Number(hozonbox_second1[jj])*byousu<=dd&&dd<=Number(hozonbox_second2[jj])*byousu){
          if(s==hozonbox_tag[jj]){
            if(login_name[login-1] == hozonbox_name[jj]){
            document.getElementById(s+"x"+dd).style.color="red";
            } 
          }
        }
      }
    }
  },false);
}

//これ後回し。chalk1の赤バージョン
function chalk3( i, j ,k ){
  var saisei1 = document.getElementById(i+"x"+j);
  saisei1.addEventListener("click",function(){
    var ddd=Math.floor(v.currentTime*byousu);
    v.currentTime=k;
    anohyouji2(i,j);
    for(var s=1;s<tagsu;s++){
      if(ddd%byousu==0){
        document.getElementById(s+"xxx"+ddd).style.color="blue";
        document.getElementById(s+"x"+ddd).style.color="blue";
      }else{
        document.getElementById(s+"xxx"+ddd).style.color="white";
        document.getElementById(s+"x"+ddd).style.color="white";
      } 
      for(var jj=0;jj<kosuu;jj++){
        if(Number(selected_second1[jj])*byousu<=ddd&&ddd<=Number(selected_second2[jj])*byousu){
          if(s==selected_tag[jj]){
            document.getElementById(s+"xxx"+ddd).style.color="green";
          }
        }
      }
      for(var jj=0;jj<hozon;jj++){
        if(Number(hozonbox_second1[jj])*byousu<=ddd&&ddd<=Number(hozonbox_second2[jj])*byousu){
          if(s==hozonbox_tag[jj]){
            if(login_name[login-1] == hozonbox_name[jj]){
            document.getElementById(s+"x"+ddd).style.color="red";
            } 
          }
        }
      }
    }
  },false);  
}

function chalk( i, j ){
  document.getElementById(i+"xx"+j).style.color="red";
}

function chalk2( i, j ){
  document.getElementById(i+"x"+j).style.color="red";
}

function chalkoriginal( i, j ){
  //この下の１０は１秒ごとに区切るための１０
  if(j%byousu==0){
    document.getElementById(i+"xx"+j).style.color="blue";
  }else{
    document.getElementById(i+"xx"+j).style.color="white";
  }
}

function blackboard(a){
  var i, j, str = "", str1 = "", str2 = "";
  //この下の１０はタグの数
  for( i = 1; i < tagsu; i ++ ){
    str = "",str1 = "", str2 = "";
    for( j = 0; j < a; j ++ ){
      //この下の１０は１秒ごとに区切るための１０
      if(j%byousu==0){
        str += '<span style="color:blue" id="'+i+'xx'+j+'">■</span>';
        str1 += '<span style="color:blue" id="'+i+'x'+j+'">■</span>';
        str2 += '<span style="color:blue" id="'+i+'xxx'+j+'">■</span>';
      }else{
        str += '<span style="color:white" id="'+i+'xx'+j+'">■</span>'
        str1 += '<span style="color:white" id="'+i+'x'+j+'">■</span>';
        str2 += '<span style="color:white" id="'+i+'xxx'+j+'">■</span>';
      }
    }
    var elm = document.getElementById( "h"+i );
    elm.innerHTML = str;
    var elm2 = document.getElementById( "i"+i );
    elm2.innerHTML = str1;
    var elm3 = document.getElementById( "j"+i );
    elm3.innerHTML = str2;
  }
}

function rightbox(a){
  var elmtag = document.getElementById( "tag" );
  var elmcomment = document.getElementById( "comment" );
  var elmsecond1 = document.getElementById( "second1" );
  var elmsecond2 = document.getElementById( "second2" );
  var elmselect = document.getElementById( "select" );
  var tag = Number(elmtag.value);
  var comment = Number(elmcomment.value);
  var second1 = Number(elmsecond1.value);
  var second2 = Number(elmsecond2.value);
  var select = Number(elmselect.value);
  if( elmcomment.value==""||elmsecond1.value==""||elmsecond2.value==""){
    alert( "全て記入してください" );
    return;
  }else if( isNaN(elmsecond1.value)||isNaN(elmsecond2.value)){
    alert( "数値を記入してください" );
    return;
  }else if( second1>=second2||second1<0||second2<0||second1>a||second2>a){
    alert( "正しい範囲の値を入力してください" );
    return;
  }
  var sta=second1*byousu;
  var clo=second2*byousu;
  for(i=sta;i<clo+1;i++){
    chalk(tag,i);
    chalk2(tag,i);
  }
  var kakikomimasu=document.getElementById("kokonibtn2");
  kakikomimasu.innerHTML='<input type="button" onClick="kakikomi('+select+')" value="書き込み">'
}

function zenkaku2Hankaku(str) {
    return str.replace(/[0-9]/g, function(s) {
        return String.fromCharCode(s.charCodeAt(0) + 0xFEE0);
    });
}

function suuji(a){
  var i, j, str = "";
  for( i = 1; i < a; i ++ ){
    str +="　　　　　　　　　"+i;
  }
  var elm2 = document.getElementById( "time" );
  elm2.innerHTML = str;
}

function log_in(){
  var elm2name = document.getElementById( "name" );
  var name_3=elm2name.value;
  greens = 0;
  if(elm2name.value==""){
    alert( "記入してください" );
    return;
  }
  for(var ii=0;ii<login+1;ii++){
    login_name[ii]=0;
  }
  if(login==0){
    login_name[0]=name_3;
    login_name_1[0]=0;
    login_name_1[0]=name_3;
  }else{
    for(var jj=0;jj<login;jj++){
      login_name[jj]=login_name_1[jj];
    }
    for(var ii=0;ii<login+1;ii++){
    login_name_1[ii]=0;
    }
    login_name[login]=name_3;
    login_name_1[login]=name_3;
    for(var jj=0;jj<login+1;jj++){
      login_name_1[jj]=login_name[jj];
    }
  }
  login=login+1;
  console.log(login_name);
  document.getElementById("kaishi").style.display ="none";
  document.getElementById("bigbig").style.display ="block";
}

//document.getElementById("kaishi").style.display ="none";
//ログイン終了ボタン作れば上のやつ入れる
</script>
<style>
  .big{
    position:relative;
  }
  .index1{
    position: absolute;
    top: 0px;
    left: 0px;
    height: 240px;
    z-index: 1;
  }
  .index2{
    position: absolute;
    top: 0px;
    left: 0px;
    height: 240px;
    z-index: 2;
  }

  .index5{
    position: absolute;
    top: 500px;
    left: 0px;
    width: 240px;
    height: 480px;
  }

  canvas{background-color: transparent;}

.fixed01,
.fixed02 {
  position: sticky;
  top: 0;
  left: 0;
  color: #fff;
  background: #333;
}
.fixed01:before,
.fixed02:before {
  content: "";
  position: absolute;
  top: -1px;
  left: -1px;
  width: 100%;
  height: 100%;
  border: 1px solid #ccc;
}

.fixed01 {
  z-index: 2;
}

.fixed02 {
  z-index: 1;
}

thead,
tbody{
  display: block;
}

tbody{
  max-width: 1400px;
  max-height: 200px;
}

.table3{
  max-width: 1400px;
  max-height: 200px;
}


</style>
</html>